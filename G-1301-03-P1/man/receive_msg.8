.\" Manpage for receive_msg.
.TH man 8 "1 Mar 2014" "1.0" "receive_msg man page"
.SH NAME
receive_msg \- recibe y une fragmentos de mensajes a través de un socket.
.SH SYNOPSIS

.BR #include 
“G-1301-03-P1-connection.h”

.B int receive_msg
(int 
.IR socket , 
void **
.IR data , 
size_t 
.IR segmentsize , 
void * 
.IR endchar
);

.SH DESCRIPTION
La función
.BR receive_msg()
recibe fragmentos de mensajes de tamaño 
.IR segmentsize 
a través del socket identificado por el descriptor de fichero
.IR socket .
Estos fragmentos son unidos y almacenados en el buffer
.IR data ,
para el que se reservará la memoria necesaria.

La función termina de recibir mensajes en el momento en el que le llegue un fragmento de tamaño menor que 
.IR segmentsize
o si en el fragmento recibido aparece como último dato la cadena apuntada por
.IR endchar .

Si 
.IR segmentsize
se especifica como 0 o un número negativo se utilizará el MSS de TCP.

.SH RETURN VALUE
En caso de éxito, la función
.BR receive_msg()
devuelve el número de bytes recibidos. En caso de error -1 es devuelto y se registra el error en el sistema de logs correspondiente.

.SH TESTS
Para probar la funcionalidad de la función se ha realizado el programa
.BR G-1301-03-P1-connection_test
que inicia un servidor que acepta conexiones. 

Una vez establecida la conexión el servidor estará a la espera de que el cliente le envíe un mensaje, que leerá y enviará de vuelta. Para cerrar el programa, el cliente pueden enviar una cadena concreta que hará que el servidor termine su ejecución.

De esta manera se prueba tanto la funcionalidad de recibir como la de enviar.

.SH SEE ALSO
send_msg(8) send(2) recv(2)
.SH AUTHOR
Enrique Cabrerizo Fernández y Guillermo Ruiz Álvarez
